<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="net.lotte.chamomile.admin.resource.domain.ResourceMapper">


  <!-- 리소스 목록 조회 -->
  <select id="findResourceListData" parameterType="net.lotte.chamomile.admin.resource.api.dto.ResourceQuery"
          resultType="net.lotte.chamomile.admin.resource.domain.ResourceVO">

    SELECT
    RESOURCE_ID resourceId, /* 리소스 아이디 */
    RESOURCE_URI resourceUri, /* 리소스 경로 */
    RESOURCE_NAME resourceName, /* 리소스 명 */
    RESOURCE_HTTPMETHOD resourceHttpMethod, /* http method */
    RESOURCE_DESC resourceDesc, /* 리소스_설명 */
    SECURITY_ORDER securityOrder, /* 리소스 순서 */
    USE_YN useYn, /* 사용 여부 */
    SYS_INSERT_DTM sysInsertDtm, /* 시스템_입력_일시 */
    SYS_INSERT_USER_ID sysInsertUserId, /* 시스템_입력_사용자_아이디 */
    SYS_UPDATE_DTM sysUpdateDtm, /* 시스템_수정_일시 */
    SYS_UPDATE_USER_ID sysUpdateUserId /* 시스템_수정_사용자_아이디 */
    FROM
    CHMM_RESOURCE_INFO A
    <!-- 검색조건 -->
    <where>
      <if test="searchType != null and searchType.equals('searchResourceId') and searchValue != null and searchValue != ''">AND RESOURCE_ID LIKE '%' || #{searchValue} || '%'</if>
      <if test="searchType != null and searchType.equals('searchResourceName') and searchValue != null and searchValue != ''">AND RESOURCE_NAME LIKE '%' || #{searchValue} || '%'</if>
      <if test="searchUseYn != null and searchUseYn != ''">AND USE_YN = #{searchUseYn}</if>
    </where>

  </select>

  <!-- 리소스 조회 -->
  <select id="findResource" parameterType="String" resultType="net.lotte.chamomile.admin.resource.domain.ResourceVO">

    SELECT RESOURCE_ID         resourceId, /* 리소스 아이디 */
           RESOURCE_URI        resourceUri, /* 리소스 경로 */
           RESOURCE_NAME       resourceName, /* 리소스 명 */
           RESOURCE_HTTPMETHOD resourceHttpMethod, /* http method */
           RESOURCE_DESC       resourceDesc, /* 리소스_설명 */
           SECURITY_ORDER      securityOrder, /* 리소스 순서 */
           USE_YN              useYn, /* 사용 여부 */
           SYS_INSERT_DTM      sysInsertDtm, /* 시스템_입력_일시 */
           SYS_INSERT_USER_ID  sysInsertUserId, /* 시스템_입력_사용자_아이디 */
           SYS_UPDATE_DTM      sysUpdateDtm, /* 시스템_수정_일시 */
           SYS_UPDATE_USER_ID  sysUpdateUserId /* 시스템_수정_사용자_아이디 */
    FROM CHMM_RESOURCE_INFO A
    WHERE RESOURCE_ID = #{resourceId}
  </select>

  <!-- 리소스 저장 -->
  <insert id="insertResource" parameterType="net.lotte.chamomile.admin.resource.domain.ResourceVO">
    <![CDATA[
    INSERT INTO CHMM_RESOURCE_INFO
        (RESOURCE_ID
        ,RESOURCE_URI
        ,RESOURCE_NAME
        ,RESOURCE_DESC
        ,RESOURCE_HTTPMETHOD
        ,SECURITY_ORDER
        ,USE_YN
        ,SYS_INSERT_DTM
        ,SYS_INSERT_USER_ID
        ,SYS_UPDATE_DTM
        ,SYS_UPDATE_USER_ID)
    VALUES
        (#{resourceId}
        ,#{resourceUri}
        ,#{resourceName}
        ,#{resourceDesc}
        ,#{resourceHttpMethod}
        ,#{securityOrder}
        ,#{useYn}
        ,#{sysInsertDtm}
        ,#{sysInsertUserId}
        ,#{sysUpdateDtm}
        ,#{sysUpdateUserId})
    ]]>
  	</insert>

  <!-- 리소스 수정 -->
  <update id="updateResource" parameterType="net.lotte.chamomile.admin.resource.domain.ResourceVO">

    UPDATE
        CHMM_RESOURCE_INFO
    SET
        RESOURCE_URI= #{resourceUri},
        RESOURCE_NAME= #{resourceName},
        RESOURCE_DESC= #{resourceDesc},
        SECURITY_ORDER= #{securityOrder},
        RESOURCE_HTTPMETHOD= #{resourceHttpMethod},
        USE_YN= #{useYn},
        SYS_UPDATE_DTM= #{sysUpdateDtm},
        SYS_UPDATE_USER_ID= #{sysUpdateUserId}
    <where>
        AND RESOURCE_ID = #{resourceId}
    </where>
  </update>

  <!-- 리소스 삭제 -->
  <delete id="deleteResource" parameterType="java.util.List">
    DELETE FROM
    CHMM_RESOURCE_INFO
    <where>
      RESOURCE_ID IN
      <foreach collection="list" item="id" open="(" separator="," close=")">
        #{id}
      </foreach>
    </where>
  </delete>

  <!-- 리소스 저장 -->
  <insert id="insertResourceExcel" parameterType="net.lotte.chamomile.admin.resource.domain.ResourceExcelVO">
    <![CDATA[
    INSERT INTO CHMM_RESOURCE_INFO
    (RESOURCE_ID
    ,RESOURCE_URI
    ,RESOURCE_NAME
    ,RESOURCE_DESC
    ,RESOURCE_HTTPMETHOD
    ,SECURITY_ORDER
    ,USE_YN
    ,SYS_INSERT_DTM
    ,SYS_INSERT_USER_ID
    ,SYS_UPDATE_DTM
    ,SYS_UPDATE_USER_ID)
    VALUES
      (#{resourceId}
      ,#{resourceUri}
      ,#{resourceName}
      ,#{resourceDesc}
      ,#{resourceHttpMethod}
      ,#{securityOrder}
      ,#{useYn}
      ,#{sysInsertDtm}
      ,#{sysInsertUserId}
      ,#{sysUpdateDtm}
      ,#{sysUpdateUserId})
    ]]>
  	</insert>

  <!-- 리소스 목록 조회 -->
  <select id="findResourceListDataExcel" parameterType="net.lotte.chamomile.admin.resource.api.dto.ResourceQuery"
          resultType="net.lotte.chamomile.admin.resource.domain.ResourceExcelVO">

    SELECT
    RESOURCE_ID resourceId, /* 리소스 아이디 */
    RESOURCE_URI resourceUri, /* 리소스 경로 */
    RESOURCE_NAME resourceName, /* 리소스 명 */
    RESOURCE_HTTPMETHOD resourceHttpMethod, /* http method */
    RESOURCE_DESC resourceDesc, /* 리소스_설명 */
    SECURITY_ORDER securityOrder, /* 리소스 순서 */
    USE_YN useYn, /* 사용 여부 */
    SYS_INSERT_DTM sysInsertDtm, /* 시스템_입력_일시 */
    SYS_INSERT_USER_ID sysInsertUserId, /* 시스템_입력_사용자_아이디 */
    SYS_UPDATE_DTM sysUpdateDtm, /* 시스템_수정_일시 */
    SYS_UPDATE_USER_ID sysUpdateUserId /* 시스템_수정_사용자_아이디 */
    FROM
    CHMM_RESOURCE_INFO A
    <!-- 검색조건 -->
    <where>
      <if test="searchType != null and searchType.equals('searchResourceId') and searchValue != null and searchValue != ''">AND RESOURCE_ID LIKE '%' || #{searchValue} || '%'</if>
      <if test="searchType != null and searchType.equals('searchResourceName') and searchValue != null and searchValue != ''">AND RESOURCE_NAME LIKE '%' || #{searchValue} || '%'</if>
      <if test="searchUseYn != null and searchUseYn != ''">AND USE_YN = #{searchUseYn}</if>
    </where>

  </select>

  <select id="findResourceListDataExcel2" resultType="net.lotte.chamomile.admin.resource.domain.ResourceExcelVO">

    SELECT
    RESOURCE_ID resourceId, /* 리소스 아이디 */
    RESOURCE_URI resourceUri, /* 리소스 경로 */
    RESOURCE_NAME resourceName, /* 리소스 명 */
    RESOURCE_HTTPMETHOD resourceHttpMethod, /* http method */
    RESOURCE_DESC resourceDesc, /* 리소스_설명 */
    SECURITY_ORDER securityOrder, /* 리소스 순서 */
    USE_YN useYn, /* 사용 여부 */
    SYS_INSERT_DTM sysInsertDtm, /* 시스템_입력_일시 */
    SYS_INSERT_USER_ID sysInsertUserId, /* 시스템_입력_사용자_아이디 */
    SYS_UPDATE_DTM sysUpdateDtm, /* 시스템_수정_일시 */
    SYS_UPDATE_USER_ID sysUpdateUserId /* 시스템_수정_사용자_아이디 */
    FROM
    CHMM_RESOURCE_INFO A

  </select>

</mapper>
